# エクセルからHTML生成ツール

## 概要

毎年の補助金データ更新を簡単にするためのPythonスクリプトです。エクセルファイルからHTMLファイルを自動生成します。

## 必要なソフトウェア

1. **Python 3.6以上**
   - Windowsの場合: https://www.python.org/downloads/ からダウンロード
   - インストール時に「Add Python to PATH」にチェックを入れてください

2. **openpyxlライブラリ**
   - コマンドプロンプト（またはターミナル）で以下を実行:
   ```
   pip install openpyxl
   ```

## エクセルファイルの形式

### 基本構造

| 都道府県 | 2012 | 2013 | 2014 | ... | 2024 | 計 |
|---------|------|------|------|-----|------|-----|
| 北海道   | 596  | 654  | 560  | ... | 1220 | 11559 |
| 青森県   | 192  | 261  | 159  | ... | 251  | 3015 |
| ...     | ...  | ...  | ...  | ... | ...  | ... |
| 総計    | 1234 | 5678 | 9012 | ... | 9999 | 99999 |

### 重要なポイント

1. **列A**: 必ず都道府県名を入れる
2. **列B以降**: 各年度のデータ（2012, 2013, 2014...）
3. **最後の列**: 「計」（合計）
4. **最終行**: 「総計」で始まる行を入れる
5. **複数シート**: ファイル内の各シートが別々のタブになります
   - 例: 「合計」「EV」「PHEV」「FCV」「原付EV」

### koufu.htmlの場合

エクセルファイルに以下のシートを作成:
- 合計
- EV
- PHEV
- FCV
- 原付EV

### koufu2.htmlの場合

エクセルファイルに以下のシートを作成:
- V2L
- V2H

### koufu3.htmlの場合

エクセルファイルに以下のシートを作成:
- 合計
- 急速
- 普通

## 使い方

### 1. エクセルファイルの準備

上記の形式でエクセルファイルを作成します。
例: `koufu_data.xlsx`

### 2. スクリプトの実行

コマンドプロンプト（またはターミナル）で以下を実行:

```bash
# koufu.htmlを生成
python excel_to_html_converter.py koufu_data.xlsx koufu.html

# koufu2.htmlを生成
python excel_to_html_converter.py koufu2_data.xlsx koufu2.html

# koufu3.htmlを生成
python excel_to_html_converter.py koufu3_data.xlsx koufu3.html
```

### 3. 生成されたHTMLの確認

ブラウザで生成されたHTMLファイルを開いて確認します。

## 毎年のデータ更新手順

### 例: 2025年度のデータを追加する場合

1. **エクセルファイルを開く** (`koufu_data.xlsx`)

2. **新しい列を追加**
   - 「計」列の前に新しい列を挿入
   - ヘッダーに「2025」と入力

3. **各都道府県の2025年度データを入力**
   ```
   北海道: 1500
   青森県: 300
   ...
   ```

4. **総計行も更新**
   - 2025年の総計を計算して入力

5. **「計」列を更新**
   - 各都道府県の新しい合計を計算
   - エクセルの数式を使うと便利: `=SUM(B2:Q2)`

6. **スクリプトを実行**
   ```bash
   python excel_to_html_converter.py koufu_data.xlsx koufu.html
   ```

7. **ブラウザで確認**
   - koufu.htmlを開いて、2025年のデータが正しく表示されているか確認

8. **完了!**

## トラブルシューティング

### エラー: "python: command not found"
- Pythonがインストールされていません
- https://www.python.org/downloads/ からダウンロードしてインストール

### エラー: "No module named 'openpyxl'"
- openpyxlライブラリがインストールされていません
- 以下を実行: `pip install openpyxl`

### エラー: "File not found"
- ファイル名が間違っているか、ファイルが存在しません
- ファイル名とパスを確認してください

### データが正しく表示されない
1. エクセルファイルの形式を確認
   - 列A: 都道府県名
   - 列B以降: 年度データ
   - 最終行: 「総計」
2. シート名を確認（タブ名として使用されます）
3. 空白セルは「－」として表示されます

## サンプルエクセルファイルの作成

簡単なサンプルを作成する手順:

1. Excelを開く
2. 新しいシートを「合計」という名前にする
3. 以下のように入力:

```
都道府県 | 2022 | 2023 | 2024 | 計
北海道   | 2055 | 1851 | 1220 | 11559
青森県   | 497  | 397  | 251  | 3015
総計    | 2552 | 2248 | 1471 | 14574
```

4. 保存: `test_data.xlsx`
5. 実行: `python excel_to_html_converter.py test_data.xlsx test.html`
6. test.htmlをブラウザで開いて確認

## サポート

問題が発生した場合は、以下の情報を含めてお問い合わせください:
1. エラーメッセージの全文
2. 使用しているエクセルファイルの構造（スクリーンショット）
3. Pythonのバージョン（`python --version`で確認）

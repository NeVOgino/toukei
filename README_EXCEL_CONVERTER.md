# エクセルからHTML生成ツール

## 概要

毎年の補助金データ更新を簡単にするためのPythonスクリプトです。エクセルファイルからHTMLファイルを自動生成します。

## 必要なソフトウェア

1. **Python 3.6以上**
   - Windowsの場合: https://www.python.org/downloads/ から最新の安定版をダウンロード
   - Macの場合: 同じく https://www.python.org/downloads/ からダウンロード
   - ⚠️ 重要: インストール時に「Add Python to PATH」（または「Add Python.exe to PATH」）のチェックボックスを必ず✓してください
     - このオプションはインストール画面に表示されます（通常、最初の画面または下部にあります）

2. **openpyxlライブラリ**
   - コマンドプロンプト（またはターミナル）で以下を実行:
   ```
   pip install openpyxl
   ```

## 準備：ファイルの配置

### 推奨フォルダ構成

作業用のフォルダを作成することをお勧めします。例えば：

```
C:\Users\あなたのユーザー名\Documents\toukei\
```

このフォルダに以下のファイルを保存します：

1. **excel_to_html_converter.py** (Pythonスクリプト)
2. **エクセルファイル** (例: koufu_data.xlsx)
3. **生成されたHTMLファイル** (例: koufu.html) ← 自動的に作成されます

### 作業フォルダの作成手順（Windows）

1. **エクスプローラーを開く**
   - キーボードの「Windowsキー + E」を押す

2. **ドキュメントフォルダに移動**
   - 左側のメニューから「ドキュメント」をクリック

3. **新しいフォルダを作成**
   - 右クリック → 「新規作成」 → 「フォルダー」
   - フォルダ名を「toukei」にする

4. **ファイルを保存**
   - `excel_to_html_converter.py` をこのフォルダに保存
   - エクセルファイルもこのフォルダに保存

## コマンドプロンプトの使い方

### コマンドプロンプトとは？

コマンドプロンプトは、文字を入力してコンピュータに命令を出すプログラムです。

### コマンドプロンプトの開き方（Windows）

**方法1: 検索から開く**
1. キーボードの「Windowsキー」を押す
2. 「cmd」または「コマンドプロンプト」と入力
3. 「コマンドプロンプト」アプリをクリック

**方法2: ファイルから開く**
1. エクスプローラーで作業フォルダ（例: `C:\Users\あなたのユーザー名\Documents\toukei\`）を開く
2. アドレスバー（フォルダのパスが表示されている部分）をクリック
3. 「cmd」と入力してEnterキーを押す
   - これで自動的に作業フォルダでコマンドプロンプトが開きます！

### 作業フォルダへの移動方法

コマンドプロンプトを通常の方法で開いた場合、作業フォルダに移動する必要があります。

**cdコマンドを使った移動**

```bash
cd C:\Users\あなたのユーザー名\Documents\toukei
```

- `cd` は「Change Directory（ディレクトリを変更）」の略です
- 例: あなたのユーザー名が「tanaka」の場合
  ```bash
  cd C:\Users\tanaka\Documents\toukei
  ```

**現在のフォルダを確認する方法**

コマンドプロンプトで以下を入力：
```bash
dir
```
- `dir` と入力してEnterを押すと、現在のフォルダにあるファイル一覧が表示されます
- `excel_to_html_converter.py` が表示されていれば、正しいフォルダにいます

### Macの場合

**ターミナルの開き方**
1. Launchpadを開く
2. 「ターミナル」と検索
3. ターミナルアプリを開く

**作業フォルダへの移動**
```bash
cd ~/Documents/toukei
```

## エクセルファイルの形式

### 基本構造

| 都道府県 | 2012 | 2013 | 2014 | ... | 2024 | 計 |
|---------|------|------|------|-----|------|-----|
| 北海道   | 596  | 654  | 560  | ... | 1220 | 11559 |
| 青森県   | 192  | 261  | 159  | ... | 251  | 3015 |
| ...     | ...  | ...  | ...  | ... | ...  | ... |
| 総計    | 1234 | 5678 | 9012 | ... | 9999 | 99999 |

### 重要なポイント

1. **列A**: 必ず都道府県名を入れる
2. **列B以降**: 各年度のデータ（2012, 2013, 2014...）
3. **最後の列**: 「計」（合計）
4. **最終行**: 「総計」で始まる行を入れる
5. **複数シート**: ファイル内の各シートが別々のタブになります
   - 例: 「合計」「EV」「PHEV」「FCV」「原付EV」

### koufu.htmlの場合

エクセルファイルに以下のシートを作成:
- 合計
- EV
- PHEV
- FCV
- 原付EV

### koufu2.htmlの場合

エクセルファイルに以下のシートを作成:
- V2L
- V2H

### koufu3.htmlの場合

エクセルファイルに以下のシートを作成:
- 合計
- 急速
- 普通

## 完全初心者向けチュートリアル

このセクションでは、初めての方向けに最初から最後まで手順を説明します。

### ステップ1: Pythonのインストール

1. https://www.python.org/downloads/ にアクセス
2. 「Download Python」ボタンをクリック
3. ダウンロードしたファイルを実行
4. **重要**: インストール画面で「Add Python to PATH」に必ずチェック✓を入れる
5. 「Install Now」をクリック
6. インストール完了後、コンピュータを再起動

### ステップ2: Pythonが正しくインストールされたか確認

1. コマンドプロンプトを開く（上記の「コマンドプロンプトの開き方」参照）
2. 以下を入力してEnterキーを押す:
   ```bash
   python --version
   ```
3. 「Python 3.x.x」のように表示されればOK
   - 表示されない場合: コンピュータを再起動してもう一度試してください

### ステップ3: openpyxlライブラリのインストール

1. コマンドプロンプトで以下を入力してEnterキーを押す:
   ```bash
   pip install openpyxl
   ```
2. インストールが完了するまで待つ（数十秒〜数分）
3. 「Successfully installed openpyxl」のようなメッセージが表示されればOK

### ステップ4: 作業フォルダの準備

1. `C:\Users\あなたのユーザー名\Documents\toukei` フォルダを作成（上記参照）
2. `excel_to_html_converter.py` をこのフォルダに保存
3. エクセルファイル（例: `koufu_data.xlsx`）もこのフォルダに保存

### ステップ5: コマンドプロンプトで作業フォルダに移動

**推奨方法（簡単）:**
1. エクスプローラーで `C:\Users\あなたのユーザー名\Documents\toukei` を開く
2. アドレスバーをクリックして「cmd」と入力してEnter
   - これで自動的に正しいフォルダでコマンドプロンプトが開きます

**通常の方法:**
1. コマンドプロンプトを開く
2. 以下を入力（あなたのユーザー名に置き換えてください）:
   ```bash
   cd C:\Users\あなたのユーザー名\Documents\toukei
   ```
3. Enterキーを押す

### ステップ6: ファイルが正しい場所にあるか確認

コマンドプロンプトで以下を入力:
```bash
dir
```

以下のファイルが表示されればOK:
- `excel_to_html_converter.py`
- `koufu_data.xlsx` (または他のエクセルファイル名)

### ステップ7: スクリプトの実行

コマンドプロンプトで以下を入力してEnterキーを押す:

```bash
python excel_to_html_converter.py koufu_data.xlsx koufu.html
```

**コマンドの意味:**
- `python` → Pythonを実行
- `excel_to_html_converter.py` → 実行するスクリプト
- `koufu_data.xlsx` → 読み込むエクセルファイル
- `koufu.html` → 出力するHTMLファイル名

### ステップ8: 生成されたHTMLの確認

1. エクスプローラーで作業フォルダを開く
2. `koufu.html` が作成されているのを確認
3. `koufu.html` をダブルクリック
4. ブラウザで開いて内容を確認

**成功です！** 🎉

## 使い方

### 1. エクセルファイルの準備

上記の形式でエクセルファイルを作成します。
例: `koufu_data.xlsx`

作業フォルダ（例: `C:\Users\あなたのユーザー名\Documents\toukei\`）に保存してください。

### 2. スクリプトの実行

**手順:**
1. コマンドプロンプトを開く
2. 作業フォルダに移動（`cd` コマンドまたはアドレスバーから「cmd」）
3. 以下のコマンドを実行:

```bash
# koufu.htmlを生成
python excel_to_html_converter.py koufu_data.xlsx koufu.html

# koufu2.htmlを生成
python excel_to_html_converter.py koufu2_data.xlsx koufu2.html

# koufu3.htmlを生成
python excel_to_html_converter.py koufu3_data.xlsx koufu3.html
```

**⚠️ 注意:**
- エクセルファイルとPythonスクリプトは同じフォルダに置く必要があります
- コマンドプロンプトは、そのフォルダで実行する必要があります

### 3. 生成されたHTMLの確認

1. エクスプローラーで作業フォルダを開く
2. 生成されたHTMLファイル（例: `koufu.html`）をダブルクリック
3. ブラウザで開いて内容を確認

## 毎年のデータ更新手順

### 例: 2025年度のデータを追加する場合

1. **エクセルファイルを開く** (`koufu_data.xlsx`)

2. **新しい列を追加**
   - 「計」列の前に新しい列を挿入
   - ヘッダーに「2025」と入力

3. **各都道府県の2025年度データを入力**
   ```
   北海道: 1500
   青森県: 300
   ...
   ```

4. **総計行も更新**
   - 2025年の総計を計算して入力

5. **「計」列を更新**
   - 各都道府県の新しい合計を計算
   - エクセルの数式を使うと便利: `=SUM(B2:Q2)`

6. **スクリプトを実行**
   ```bash
   python excel_to_html_converter.py koufu_data.xlsx koufu.html
   ```

7. **ブラウザで確認**
   - koufu.htmlを開いて、2025年のデータが正しく表示されているか確認

8. **完了!**

## トラブルシューティング

### エラー: "python: command not found" または "'python' は、内部コマンドまたは外部コマンド...として認識されていません"

**原因:** Pythonがインストールされていないか、PATHが設定されていません

**解決方法:**
1. Pythonがインストールされているか確認
   - https://www.python.org/downloads/ からダウンロードしてインストール
   - インストール時に「Add Python to PATH」に必ずチェック✓
2. コンピュータを再起動
3. 再度試してみる

### エラー: "No module named 'openpyxl'"

**原因:** openpyxlライブラリがインストールされていません

**解決方法:**
1. コマンドプロンプトを開く
2. 以下を実行: 
   ```bash
   pip install openpyxl
   ```
3. インストール完了を待つ
4. もう一度スクリプトを実行

### エラー: "File not found" または "ファイルが見つかりません"

**原因:** ファイル名が間違っているか、ファイルが正しい場所にありません

**解決方法:**
1. **ファイルの場所を確認**
   - コマンドプロンプトで `dir` と入力
   - エクセルファイルとPythonスクリプトが表示されることを確認

2. **正しいフォルダにいるか確認**
   - コマンドプロンプトに表示されているパスを確認
   - 例: `C:\Users\tanaka\Documents\toukei>`
   - 違う場合は `cd` コマンドで移動

3. **ファイル名を確認**
   - スペルミス、拡張子（.xlsx）を確認
   - ファイル名をコピー＆ペーストすると確実

**ヒント:** エクスプローラーでファイル名をShiftキーを押しながら右クリック→「パスのコピー」で正確なパスを取得できます

### エラー: コマンドを入力しても何も起こらない

**原因:** 作業フォルダに移動できていない可能性があります

**解決方法:**
1. エクスプローラーで作業フォルダを開く（例: `C:\Users\あなたのユーザー名\Documents\toukei`）
2. アドレスバー（フォルダのパスが表示されている部分）をクリック
3. 「cmd」と入力してEnterキーを押す
4. 新しく開いたコマンドプロンプトでもう一度実行

### データが正しく表示されない

1. **エクセルファイルの形式を確認**
   - 列A: 都道府県名
   - 列B以降: 年度データ
   - 最終行: 「総計」

2. **シート名を確認**（タブ名として使用されます）
   - koufu.html用: 合計、EV、PHEV、FCV、原付EV
   - koufu2.html用: V2L、V2H
   - koufu3.html用: 合計、急速、普通

3. **空白セルについて**
   - 空白セルは「－」として表示されます

### その他のよくある問題

**Q: エクセルファイルを開いたまま実行できますか？**
A: 通常は可能ですが、まれにエラーが発生することがあります。確実に実行するには、エクセルファイルを閉じてから実行することをお勧めします。

**Q: 複数のエクセルファイルを一度に処理できますか？**
A: いいえ、一つずつ実行する必要があります。

**Q: 生成されたHTMLファイルはどこに保存されますか？**
A: エクセルファイルと同じフォルダ（作業フォルダ）に保存されます。

## サンプルエクセルファイルの作成

簡単なサンプルを作成する手順:

1. Excelを開く
2. 新しいシートを「合計」という名前にする
3. 以下のように入力:

```
都道府県 | 2022 | 2023 | 2024 | 計
北海道   | 2055 | 1851 | 1220 | 11559
青森県   | 497  | 397  | 251  | 3015
総計    | 2552 | 2248 | 1471 | 14574
```

4. 保存: `test_data.xlsx`
5. 実行: `python excel_to_html_converter.py test_data.xlsx test.html`
6. test.htmlをブラウザで開いて確認

## サポート

問題が発生した場合は、以下の情報を含めてお問い合わせください:
1. エラーメッセージの全文
2. 使用しているエクセルファイルの構造（スクリーンショット）
3. Pythonのバージョン（`python --version`で確認）
